<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Home - When Flag Clicked</title>
    <meta property="og:title" content="When Flag Clicked" />
    <meta property="og:description" content="When Flag Clicked is something." />
  </head>
  <body>
    <video
      autoplay
      muted
      id="intro-video"
      src="/assets/intro.mp4"
      @ended="introEnd($event)"
      v-show="!introWatched"
    ></video>
    <div style="display: none" v-show="introDone || introWatched">
      <navbar></navbar>
      <div id="content" v-html="html"></div>
      <footerbar></footerbar>
    </div>
    <script>
      function getCookies() {
        let cookies = {};
        document.cookie.split(";").every((s) => {
          if (!s.length) return;
          let [name, value] = s.trim().split("=");
          cookies[name] = value;
        });
        return cookies;
      }
      function setCookie(name, value) {
        let cookies = getCookies();
        console.log(cookies);
        cookies[name] = value;
        let newcookies = "";
        for (cookie in cookies) {
          console.log(cookie);
          newcookies += `${cookie}= ${cookies[cookie]}; `;
        }
        console.log(newcookies);
        document.cookie = newcookies;
      }

      window.app = Vue.createApp({
        data() {
          return {
            introWatched: true,
            introDone: false,
            html: marked(
              `
<center><h2>This Week's Featured Tutorial</h2></center>
<center><h3>Tutorial Name - Username</h3></center>
<center>
<iframe src="/tutorials/1?hidenav=true" id="featured-iframe" width="800" height="800" allowtransparency="true" frameborder="0" scrolling="no" allowfullscreen></iframe></center>

`
            ),
          };
        },
        methods: {
          introEnd(event) {
            this.introDone = true;
            event.target.classList.add("fade");
            setTimeout(() => {
              event.target.style.display = "none";
            }, 1000);
          },
        },
        mounted() {
          console.log(getCookies().introwatched);
          this.introWatched = getCookies().introwatched === "true";
          setCookie("introwatched", "true");
        },
      });
    </script>
  </body>
</html>
